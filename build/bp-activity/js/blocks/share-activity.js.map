{"version":3,"sources":["bp-activity/js/blocks/share-activity/constants.js","bp-activity/js/blocks/share-activity/edit.js","bp-activity/js/blocks/share-activity.js"],"names":["INITIAL_BORDER_RADIUS_POSITION","MIN_BORDER_RADIUS_VALUE","MAX_BORDER_RADIUS_VALUE","ShareActivityEdit","element","Fragment","createElement","i18n","__","blockEditor","RichText","getColorClassName","InspectorControls","getColorObjectByColorValue","getColorObjectByAttributeValues","PanelColorSettings","data","useSelect","components","PanelBody","RangeControl","ToggleControl","wp","identity","isEqual","isObject","pickBy","mapValues","lodash","cleanEmptyObject","object","cleanedNestedObjects","undefined","attributes","setAttributes","text","backgroundColor","textColor","borderRadius","style","wpLoginLinkFallback","backgroundClass","textClass","colors","select","getSettings","className","styleProps","styleColors","background","color","onChangeColor","name","value","colorObject","attributeName","colorSlug","slug","newStyle","newNamedColor","newAttributes","label","onChange","blocks","registerBlockType","title","description","icon","foreground","src","category","type","default","supports","multiple","align","edit"],"mappings":"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","file":"share-activity.js","sourceRoot":"../src","sourcesContent":["/**\n * Identifier for the initial border radius position.\n *\n * @type {integer}\n */\nexport const INITIAL_BORDER_RADIUS_POSITION = 5;\n\n/**\n * Identifier for the min border radius value.\n *\n * @type {integer}\n */\nexport const MIN_BORDER_RADIUS_VALUE = 0;\n\n/**\n * Identifier for the max border radius value.\n *\n * @type {integer}\n */\nexport const MAX_BORDER_RADIUS_VALUE = 50;\n","/**\n * WordPress dependencies.\n */\nconst {\n\telement: {\n\t\tFragment,\n\t\tcreateElement,\n\t},\n\ti18n: {\n\t\t__,\n\t},\n\tblockEditor: {\n\t\tRichText,\n\t\tgetColorClassName,\n\t\tInspectorControls,\n\t\tgetColorObjectByColorValue,\n\t\tgetColorObjectByAttributeValues,\n\t\tPanelColorSettings,\n\t},\n\tdata: {\n\t\tuseSelect,\n\t},\n\tcomponents: {\n\t\tPanelBody,\n\t\tRangeControl,\n\t\tToggleControl,\n\t},\n} = wp;\n\n/**\n * External dependencies.\n */\nconst {\n\tidentity,\n\tisEqual,\n\tisObject,\n\tpickBy,\n\tmapValues,\n} = lodash;\n\n/**\n * Internal dependencies.\n */\nimport {\n\tINITIAL_BORDER_RADIUS_POSITION,\n\tMIN_BORDER_RADIUS_VALUE,\n\tMAX_BORDER_RADIUS_VALUE,\n} from './constants';\n\nconst cleanEmptyObject = ( object ) => {\n\tif ( ! isObject( object ) ) {\n\t\treturn object;\n\t}\n\tconst cleanedNestedObjects = pickBy(\n\t\tmapValues( object, cleanEmptyObject ),\n\t\tidentity\n\t);\n\treturn isEqual( cleanedNestedObjects, {} ) ? undefined\n\t\t: cleanedNestedObjects;\n};\n\nconst ShareActivityEdit = ( { attributes, setAttributes } ) => {\n\tconst { text, backgroundColor, textColor, borderRadius, style, wpLoginLinkFallback } = attributes;\n\tconst backgroundClass = getColorClassName( 'background-color', backgroundColor );\n\tconst textClass = getColorClassName( 'color', textColor );\n\tconst { colors } = useSelect( ( select ) => {\n\t\treturn select( 'core/block-editor' ).getSettings();\n\t}, [] );\n\n\tlet className = 'wp-block-button__link';\n\tlet styleProps = {};\n\tlet styleColors = {\n\t\ttext: '',\n\t\tbackground: '',\n\t};\n\n\tif ( style ) {\n\t\tif ( style.color.text ) {\n\t\t\tstyleColors.text = style.color.text;\n\t\t\tstyleProps.color = style.color.text;\n\t\t}\n\n\t\tif ( style.color.background ) {\n\t\t\tstyleColors.background = style.color.background;\n\t\t\tstyleProps.backgroundColor = style.color.background;\n\t\t}\n\t}\n\n\tif ( !! backgroundClass || styleColors.background ) {\n\t\tclassName += ' has-background';\n\n\t\tif ( !! backgroundClass ) {\n\t\t\tclassName += ' ' + backgroundClass;\n\t\t}\n\t}\n\n\tif ( !! textClass || styleColors.text ) {\n\t\tclassName += ' has-text-color';\n\n\t\tif ( !! textClass ) {\n\t\t\tclassName += ' ' + textClass;\n\t\t}\n\t}\n\n\tconst onChangeColor = ( name ) => ( value ) => {\n\t\tconst colorObject = getColorObjectByColorValue( colors, value );\n\t\tconst attributeName = name + 'Color';\n\t\tconst colorSlug = colorObject && colorObject.slug ? colorObject.slug : undefined;\n\t\tconst newStyle = {\n\t\t\t...style,\n\t\t\tcolor: {\n\t\t\t\t...styleColors,\n\t\t\t\t[ name ]: value,\n\t\t\t},\n\t\t};\n\n\t\tconst newNamedColor = colorSlug ? colorSlug : undefined;\n\t\tconst newAttributes = {\n\t\t\tstyle: cleanEmptyObject( newStyle ),\n\t\t\t[ attributeName ]: newNamedColor,\n\t\t};\n\n\t\tsetAttributes( newAttributes );\n\t};\n\n\treturn(\n\t\t<Fragment>\n\t\t\t<div className=\"wp-block-button\">\n\t\t\t\t<RichText\n\t\t\t\t\tplaceholder={ __( 'Add text', 'buddypress' ) }\n\t\t\t\t\tvalue={ text }\n\t\t\t\t\tallowedFormats={ ['core/bold', 'core/italic'] }\n\t\t\t\t\tonChange={ ( value ) => setAttributes( { text: value } ) }\n\t\t\t\t\tclassName={ className }\n\t\t\t\t\tstyle={ {\n\t\t\t\t\t\tborderRadius: borderRadius\n\t\t\t\t\t\t\t? borderRadius + 'px'\n\t\t\t\t\t\t\t: 0,\n\t\t\t\t\t\t...styleProps,\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Unconnected users Settings', 'buddypress' ) } initialOpen={ true }>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Fallback to the WordPress login link', 'buddypress' ) }\n\t\t\t\t\t\tchecked={ !! wpLoginLinkFallback }\n\t\t\t\t\t\tonChange={ () => {\n\t\t\t\t\t\t\tsetAttributes( { wpLoginLinkFallback: ! wpLoginLinkFallback } );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\thelp={\n\t\t\t\t\t\t\twpLoginLinkFallback\n\t\t\t\t\t\t\t\t? __( 'Toggle to hide the button to unconnected users.', 'buddypress' )\n\t\t\t\t\t\t\t\t: __( 'Toggle to use the WordPress login link for unconnected users.', 'buddypress' )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t\t<PanelBody title={ __( 'Border settings', 'buddypress' ) } initialOpen={ false }>\n\t\t\t\t\t<RangeControl\n\t\t\t\t\t\tvalue={ borderRadius }\n\t\t\t\t\t\tlabel={ __( 'Border radius', 'buddypress' ) }\n\t\t\t\t\t\tmin={ MIN_BORDER_RADIUS_VALUE }\n\t\t\t\t\t\tmax={ MAX_BORDER_RADIUS_VALUE }\n\t\t\t\t\t\tinitialPosition={ INITIAL_BORDER_RADIUS_POSITION }\n\t\t\t\t\t\tallowReset\n\t\t\t\t\t\tonChange={ ( value ) => setAttributes( { borderRadius: value } ) }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t\t<PanelColorSettings\n\t\t\t\t\ttitle={ __( 'Color Settings', 'buddypress' ) }\n\t\t\t\t\tinitialOpen={ false }\n\t\t\t\t\tcolorSettings={\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __( 'Text Color', 'buddypress' ),\n\t\t\t\t\t\t\t\tonChange: onChangeColor( 'text' ),\n\t\t\t\t\t\t\t\tvalue: getColorObjectByAttributeValues(\n\t\t\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t\t\t\ttextColor,\n\t\t\t\t\t\t\t\t\tstyleColors.text,\n\t\t\t\t\t\t\t\t).color,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __( 'Background Color', 'buddypress' ),\n\t\t\t\t\t\t\t\tonChange: onChangeColor( 'background' ),\n\t\t\t\t\t\t\t\tvalue: getColorObjectByAttributeValues(\n\t\t\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t\t\t\tbackgroundColor,\n\t\t\t\t\t\t\t\t\tstyleColors.background,\n\t\t\t\t\t\t\t\t).color,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</InspectorControls>\n\t\t</Fragment>\n\t);\n};\n\nexport default ShareActivityEdit;\n","/**\n * WordPress dependencies.\n */\nconst {\n\ti18n: {\n\t\t__,\n\t},\n\tblocks: {\n\t\tregisterBlockType,\n\t},\n} = wp;\n\n/**\n * Internal dependencies.\n */\nimport ShareActivityEdit from './share-activity/edit';\nimport { INITIAL_BORDER_RADIUS_POSITION } from './share-activity/constants';\n\nregisterBlockType( 'bp/share-activity', {\n\ttitle: __( 'Share into activities', 'buddypress' ),\n\tdescription: __( 'Action button to share the displayed post/page into user’s activity stream.', 'buddypress' ),\n\ticon: {\n\t\tbackground: '#fff',\n\t\tforeground: '#d84800',\n\t\tsrc: 'buddicons-activity',\n\t},\n\tcategory: 'buddypress',\n\tattributes: {\n\t\ttext: {\n\t\t\ttype: 'string',\n\t\t\tdefault: __( 'Share into my Activities', 'buddypress' ),\n\t\t},\n\t\tborderRadius: {\n\t\t\ttype: 'number',\n\t\t\tdefault: INITIAL_BORDER_RADIUS_POSITION,\n\t\t},\n\t\tstyle: {\n\t\t\ttype: 'object',\n\t\t},\n\t\tbackgroundColor: {\n\t\t\ttype: 'string',\n\t\t},\n\t\ttextColor: {\n\t\t\ttype: 'string',\n\t\t},\n\t\twpLoginLinkFallback: {\n\t\t\ttype: 'boolean',\n\t\t\tdefault: true,\n\t\t},\n\t},\n\tsupports: {\n\t\tmultiple: false,\n\t\talign: true,\n\t},\n\tedit: ShareActivityEdit,\n} );\n"]}